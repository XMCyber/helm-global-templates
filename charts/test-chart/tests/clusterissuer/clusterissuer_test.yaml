suite: Test ClusterIssuer template
templates:
  - template.yaml

tests:
  - it: should create basic issuer correctly
    values:
      - clusterissuer_values.yaml
    asserts:
      - equal:
          path: kind
          value: ClusterIssuer
      - equal:
          path: apiVersion
          value: cert-manager.io/v1
      - equal:
          path: metadata.name
          value: test-issuer
      - equal:
          path: metadata.namespace
          value: test-namespace
      - equal:
          path: spec.ca.secretName
          value: test-secret

  - it: should set labels and annotations correctly
    set:
      issuers:
        - name: test-issuer
          namespace: test-namespace
          labels:
            app: test-app
    asserts:
      - equal:
          path: metadata.labels.app
          value: test-app